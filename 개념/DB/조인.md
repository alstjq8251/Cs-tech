## JOIN
1. EQUI(등가)조인 (교집합)
   1. EQUI(등가) 조인
    - **조인은 여러 개의 릴레이션을 사용해서 새로운 릴레이션을 만드는 과정이다.**
    - 조인의 가장 기본은 교집합을 만드는 것이다.
    - 두 개의 테이블 간에 일치하는 것을 조인한다.
      - SELECT * FROM EMP, DEPT WHERE EMP.DEPTNO = DEPT.DEPTNO; 
      - EQUI조인은 '='을 사용하여 두 개의 테이블을 연결한다. , where조건절에 추가 조건을 사용 가능하다.
    - EQUI 조인을 한 후에 실행 계획을 확인해서 내부적으로 두 테이블을 어떻게 연결했는지 확인할 수 있다.
    - 두 개 이상의 테이블 전체를 읽은 뒤에(TABLE ACCESS FULL) 해시 함수를 사용해서 두 개의 테이블을 연결한 것 이다.
    -  <details>
       <summary>해시 함수</summary>
       <div>
         
         - 해시 함수는 테이블을 해시 메모리에 적재한 후에 해시 함수로써 연결하는 방법이다.
            - 해시 함수는 EUQI조인만 사용 가능한 방법이다.
         - `해시 조인`
            - 해시 조인은 먼저 선행 테이블을 결정하고 선행 테이블에서 주어진 조건에(where 절) 해당하는 행을 선택한다.
            - 해당 행이 선택되면 조인 키(JOIN Key)를 기준으로 해시 함수를 사용해서 해시 테이블을 메인 메모리(Main Memory)에
         
              생성하고 후행 테이블에서 주어진 조건에 만족하는 행을 찾는다.
            - 후행 테이블의 조인 키를 사용해서 해시 함수를 적용하여 해당 버킷을 검색한다.
            - 해시코드 : 메모리를 구별할 수 있는 유일한 값을 정수값을 표식

       </div>
       </details>
   2. INNERJOIN
    - EQUI조인과 마찬가지로 ISO 표준 SQL로 INNER JOIN이 있다. 
      - INNER JOIN 은 ON문을 사용해서 테이블을 연결한다.
      - SELECT * FROM EMP INNERJOIN DEPT ON ~;
   3. INTERSECT 연산
    - **INTERSECT연산은 두 개의 테이블에서 교집합을 조회**한다.
    - **즉, 두 개의 테이블에서 공통된 값을 조회한다.**
      - SELECT DEPTNO FROM EMP INTERSECT SELECT DEPTNO FROM DEPT;  
      - 교집합의 조건이 되는 값을 칼럼값으로 지정해야 한다.
2. Non-EQUI(비등가) 조인
  - Non-EQUI는 두 개의 테이블간에 '='을 사용하지 않고 '>' '<' '>=' '<=' 등을 사용한다.
  - **즉 Non-EQUI는 정확하게 일치하지 않는 값을 조인하는 것**이다.
3. OUTER JOIN
  - **OUTER JOIN은 두 개의 테이블간에 교집합(EQUI JOIN)을 조회하고 한 쪽 테이블에만 있는 데이터도 포함시켜서 조회**한다.
    - 이때 **왼쪽 테이블에만 있는 행도 포함하면 LEFT OUTER JOIN이라고 하고 오른쪽에만 있는 행도 포함하면 RIGHT OUTER JOIN**이라고 한다.
    - **FULL OUTER JOIN은 LEFT OUTER JOIN 과 RIGHT OUTER JOIN 모두를 하는 것**이다.
    - oracle db에선 OUTER JOIN 을 할 때 '+' 기호를 사용해서 할 수 있다.
4. CROSS JOIN
  - **CROSS JOIN은 조인 조건구문 없이 2개의 테이블을 하나로 조인한다.**
  - **조인구가 없기 때문에 카테시안곱이 발생한다.**
    - 행이 14개 있는 테이블과 행이 4개있는 테이블을 조인하면 56개의 행이 조회된다.
  - CROSS JOIN은 FROM절에 "CROSS JOIN"구문을 사용하면 된다.
  - MERGE JOIN으로 실행결과가 출력된다.
5. UNION을 사용한 합집합 구현
   1. UNION
     - **UNION연산은 두 개의 테이블을 하나로 만드는 연산**이다.
       - 즉,두 개의 테이블을 하나로 합치는 것이며, 두 개의 테이블의 칼럼 수 , 칼럼의 데이터 형식 모두가 일치해야 한다.
       - 만약 두 개의 테이블에 UNION 연산이 사용될 때 칼럼의 개수 혹은 데이터 형식이 다르면 오류가 발생한다.
     - UNION연산은 중복된 데이터를 제거하면서 테이블을 합친다.
       - 그래서 UNION 연산은 정렬(SORT)과정을 발생시킨다.
     - ex: SELECT U.USERID FROM USERTBL UNION B.USERID FROM BUYTBL  
   2. UNION ALL
     - **UNION ALL은 두 개의 테이블을 하나로 합치는 것이다. UNION처럼 중복을 제거하거나 정렬을 유발하지 않는다.**
     - ex: SELECT U.USERID FROM USERTBL UNION ALL B.USERID FROM BUYTBL  
 6. 차집합을 만드는 MINUS
   - **MINUS 연산은 두 개의 테이블에서 차집합을 조회한다.**
   - **즉, 먼저 쓴 SELECT문에는 있고 뒤에 쓰는 SELECT문에는 없는 집합을 조회하는 것**이다.
   - MS-SQL에서는 MINUS와 동일한 연산이 EXCEPT이다.
   - MYSQL에서는 지원하지 않는다.(NOT IN, NOT EXISTS등 사용)
   - SELECT U.USERID FROM USERTBL U MINUS B.USERID FROM BUYTBL B; 

## 계층형 조회(Connect by)
![image](https://github.com/alstjq8251/Cs-tech/assets/98382954/8aed385c-f401-437c-b0a3-41d0f257ad4e)

`정의`
  - **계층형 조회는 ORACLE 데이터베이스에서 지원하는 것으로 계층형으로 데이터를 조회할 수 있다.**
  - 직급으로 예를들면 차장 부장 팀장 대리 사원 순으로 트리 형태의 구조를 위에서 아래로 탐색하면서 조회하는 것이다.
    - 역방향 조회 또한 가능하다.
- **Connect by는 트리(Tree)형태의 구조로 질의를 수행하는 것으로 START WITH구는 시작 조건을 의미하고 CONNECT BY PRIOR는 조인 조건이다.**
- **Root노드로부터 하위 노드의 질의를 실행한다.**
- **계층형 조회에서 MAX(LEVEL)을 사용하여 최대 계층 수를 구할 수 있다.**
   - 즉, 계층형 구조에서 마지막 Left Node의 계층 값을 구한다.
   - SELECT MAX(LEVEL) FROM C#PERPEAR.EMP START WITH MGR IS NULL CONNECT BY PRIOR EMPNO = MGR; 
- **계층형 조회의 결과를 명확히 보기 위해서 LPAD함수를 사용할 수 있다.**
   - SELECT LEVEL, LPAD(' ',4*(LEVEL-1)) || EMPNO , MGR, CONNECT_BY_ISLEAF FROM EMP START WITH MGR IS NULL

     CONNECT BY PRIOR EMPNO = MGR;
     
     - CONNECT_BY_ISLEAF: 계층형 쿼리에서 해당하는 로우가 자식노드가 있는지 없는지 여부를 체크 (있을 경우 0 , 없을 경우 1)
     - CONNECT_BY_ROOT: 계층형 쿼리에서 최상위 노드를 찾고자 할 때 사용
     - ORACLE LPAD 함수: 좌측에 자릿수 만큼 채워주는 함수 LPAD(변수,길이,변형자)
     - <details>
       <summary>CONNECT BY 키워드</summary>
       <div>
          
          | 키워드 | 설명|
          | :--: | :--: |
          | LEVEL | 검색 항목의 깊이를 의미한다. 즉, 계층 구조에서 가장 상위 레벨이 1이 된다.|
          | CONNECT_BY_ROOT | 계층 구조에서 가장 최상위 값을 표시한다.|
          | CONNECT_BY_ISLEAF | 계층 구조에서 가장 최하위를 표시한다.|
          | SYS_CONNECT_BY_PATH | 계층 구조에서 전체 전개 경로를 표시한다.|
          | NOCYCLE | 순환구조가 발생지점까지만 발생한다.|
          | CONNECT_BY_ISCYCLE | 순환구조 발생 지점을 표시한다.|

       </div>
       </details>

> MYSQL에서는 SELF JOIN 이 계층형 조회같은 역할을 지원한다.

### REFERENCE
<https://www.inflearn.com/course/lecture?courseSlug=sqld-%EC%9E%90%EA%B2%A9%EC%A6%9D-%EC%B4%88%EA%B8%89-2&unitId=103395&tab=curriculum><br>
<https://blog.naver.com/javaking75/220010288704>



