# Protocal Layer

### Potocal 이란?

![image](https://user-images.githubusercontent.com/98382954/180723439-36965710-43f5-418d-bada-75761cecd928.png)
 - 프로토콜(protocol)이란 표준화된 절차를 서술한 규칙의 체계를 말하는 것으로, 규약(規約)이라고도 한다. <br> 쉽게 네트워크 상 컴퓨터간의 대화라고 이해하는데 여기서 대화란 데이터를 주고 받는 것 <br>즉 통신 주체들 사이의 언제 어떻게 어떤 내용을 통신할 지를 정하는 규칙이라고도 말한다.

### Protocal의 개요
- 프로토콜은 공통의 데이터 교환 방법 및 순서에 대해 정의한 의사소통 약속, 규약 혹은 규칙 체계를 말한다.
- 일반적으로 프로토콜은 통신 프로토콜을 의미하게 되는데 통신 프로토콜 또는 통신 규약은 컴퓨터나 원거리 통신 장비 사이에서 <br>메시지를 주고받는 양식과 규칙의 체계를 뜻한다.
- 통신 프로토콜 또는 규약은 신호 체계, 인증, 오류 감지 및 수정 기능 등을 포함할 수 있는데 언어외에도 데이터가 어떤 과정과 <br>절차를 통해 송신했는지, 수신측에서는 어떻게 원래의 데이터로 복구할 수 있는지와 같은 약속도 프로토콜, 규약에 포함된다.
- 프로토콜은 물리적, 소프트웨어적인 면등 다양한 측면을 고려하여 결정하게 되는데 동일한 통신망을 이용하더라도 같은 프로토콜을 <br> 이용하는 컴퓨터들 사이에서만 통신이 가능하다.
- 컴퓨터 끼리 혹은 다른 단말기와 통신이 필요한 경우 정보를 원활하게 교환하게 해주는 ~~기능에서 기술~~ 여러 통신 규칙과 방법의 집합이고<br> 상호간에 이해할 수 있는 데이터를 신뢰성이 유지되도록 하는 표현 형식이다.
- - 이기종간의 통신시 표준 프로토콜을 이용해 통신망을 설정해야 하며 단순 메시지 전송 외 프로세스간 파일 접근 및 DB에 접근 <br> 제어 처리 등 통신기능을 실현하려면 프로토콜을 사용해야만 한다. __이기종간엔 protocal이 다르기 때문에 표준 프로토콜을 각각 <br>채용하여 통신망을 구성해야 통신이 가능하기 때문이다.__
 ##### 표준 프로토콜이 만들어져 있지 않을 때 자사 제품간 독자적인 체계를 만들었기에 이기종간 통신이 매우 어려웠는데 원활하고 확실한 통신을 위해 <br>각 수준의 통신 규약을 완전하게 규정하고 표준화 할 필요하게 되어 국제적으론 국제표준화기구(ISO) 국제전기통신연합(ITU)등이 표준화를 시도하고 있다.
 ##### 데이터 통신 전반의 규칙을 표준화한 대표적인 것이 ISO에서 작성한 OSI 모델이며 공중 데이터망(PDN)에 통신 규약을 표준화한 것이 ITU-T에서 작성한<br> X계열의 권고이며 OSI참조 모델과 다르며 개방형 시스템 간 상호 접속(OSI)이 개발되기 전 널리 사용된 통신 규약은 최초로 프로토콜을 표준화한 IBM의 SNA(System Network Architeture)이다. <br>인터넷용으로 개발되어 통신규약으로 사용되는 것은 TCP/IP이다.
  
### 프로토콜의 구성 요소
 - 프로토콜은 구문(syntax), 의미(sematic), 타이밍(timing)으로 구성되어 있다.
 - + `구문`은 데이터를 어떻게 구성할 지에 대한 형식, 구체적인 코딩 방법, 신호 레벨 등에 대한 형식을 규정한다. 
 - - `의미`는 데이터에 대하여 구체적으로 어떻게 제어할 것인지에 대한 처리 방법과 오류가 발생했을 때 어떻게 처리할 것인가에 대한 정보를 포함한다. 
 - - `타이밍`은 통신이 이루어질 때 데이터를 주고받을 속도에 대한 조절과, 여러 데이터가 동시에 통신을 해야 할 경우 순서 관리를 위한 기법을 포함한다.

### 프로토콜의 특징
- 네트워크는 계층으로 분리되어 각 계층에서 사용되는 프로토콜이 다른데 프로토콜은 계층적 관점에서 논리적인 측면, 물리적인 측면으로 <br>구분이 가능하다.
- `물리적인 측면`에선 프로토콜은 자료 전송에 쓰이는 전송 매체, 접속용 단자 및 전송신호, 회신규격 등을 말한다.
- `논리적인 측면`프로토콜은 프레임의 구성, 프레임 안에 있는 각 항목의 뜻과 기능, 자료 전송의 절차 등을 담게 되는데 <br>이 프로토콜은 폐쇄적인 프로토콜과 범용 프로토콜로 구분이 가능하다.
- > `폐쇄적인 프로토콜`  각 기업의 장치들끼리 통신하기 위한 독자적인 통신 규약이며, 자세한 규격이 공개되어 있지 않아, 크래킹 위협에 <br>상대적으로 안전하다
- > `범용 프로토콜` 공개된 범용 프로토콜은 여러 장치에 쓰이는 널리 알려진 규격이며, 규격이 널리 공개되어 있어, 컴퓨터와 네트워크 <br>크래킹에 취약한 편이다
- > > `크래킹` 다른 사람의 통신망이나 컴퓨터 시스템에 정당한 접근 권한 없이 접근하거나 허용된 접근 권한의 범위를 초과하여 침입하는 행위를 말한다. <br>크래킹은 해킹(Hacking)과 비슷한 의미로 사용되는 용어로서, 불법적 접근을 통해 다른 사람의 컴퓨터 시스템이나 통신망을 파괴하는 행위를 일컫는다.

- 프로토콜은 특성에 따라 직접 프로토콜과 간접 프로토콜, 단일체 프로토콜과 구조적 프로토콜, 대칭 프로토콜과 비대칭 프로토콜 등이 있다.

### 프로토콜의 기능
<img width="85%" height="10%" alt="image" src="https://user-images.githubusercontent.com/98382954/180732602-a857ee09-6df8-4898-8151-ff5cead6a0c9.png"><br>
- `주소설정(Addressing)` 통신을 하려면 통신의 대상이 누구인지를 알아야 데이터를 전송할 수 있다. 프로토콜에는 각 전송 계층에 맞는 주소를 <br>지정하는 기능이 있다
- `순서제어(Sequence Control):` 순서제어란 프로토콜 데이터 단위((Protocol Data Unit, PDU)가 전송될 때 순서를 명시하는 기능이며, 연결 지향형에만 사용한다. 순서를 지정하는 이유는 흐름제어, 혼잡제어, 오류제어를 위해서다. <br>순서제어에 의해서 정해진 프로토콜 데이터 단위를 수신측에 보내면 순서에 맞게 데이터를 재구성하고, 오류가 있을 경우 <br>재전송을 요청한다. <br>해커는 순서제어의 특성을 이용해 순서가 뒤죽박죽인 패킷을 생성하여 보내, 시스템 과부하를 야기하기도 한다.
- `분할 및 재조립(Fragmentation&Reassembly)` 데이터의 크기와 종류는 다양한데, 한꺼번에 덩어리가 큰 데이터를 전달하는 것은 통신에 있어서 비효율적이기 때문에 하나의 데이터를 전송 효율이 높은 작은 단위로 분할하여 전송하고 수신측에서는 해당 데이터를 사용하기 위해 재조립하는 과정을 거친다. <br>해커는 이런 과정에서 데이터 분할 기능을 이용해 대량의 패킷을 공격 대상에게 보내기도 하고, 재조합 불가능한 데이터를 보내 <br>혼란에 빠뜨리기도 한다.
- `캡슐화(Encapsulation)` 프로토콜 데이터 단위(PDU)는 PCI(Protocol Control Informaion, PCI)와 서비스 데이터 단위(Sercive Data Unit, SDU)로 구성된다. PCI는 발신지 주소, 수신지 주소, 순서 번호, 오류 검출 코드 등 각종 헤더 정보를 담고 있고, 서비스 데이터 단위에는 <br>실제 서비스 데이터 정보를 담고 있다. 통신을 구성하는 각각의 계층을 통과하기 위해서는 캡슐화를 통해 포장하는 과정을 거치며, 데이터를 사용하기 위해서는 수신측에서 캡슐화된 데이터를 역캡슐화 하는 과정을 통해 각각의 계층을 통과한다. <br>캡슐화는 해커로부터 자신의 통신 내용을 숨길 수 있게 해준다.
- `흐름 제어(Flow Control)` 송신측에서 오는 데이터의 양이나 속도를 조절하는 기능이다. 송신과 수신에 있어서 속도차이로 인한 데이터의 유실을 방지한다. 송신 노드의 송신 속도가 수신노드 측의 처리 속도, 처리 능력을 고려하여, 송신자가 정보를 내보낼 때 상대방이 수신할 수 있는 만큼만 효율적으로 전송한다. 수신 장치의 데이터가 초과되어 상호 간에 데이터 손실이 발생하지 않도록 전송되는 정보 흐름의 양, 속도를 조절, 조정, 제어하기 위한 송신장치 제어 방법 혹은 기술이다. 정리하자면, 수신 장치가 모든 송신장치로부터 받은 데이터를 수신 장치의 버퍼에서 처리하기 전에, 송신장치로부터 수신 장치에게 다른 데이터가 추가적으로 전송되지 않도록 제어하는 방식이다. 수신 노드가 수신 확인응답을 송신 노드에 제공함으로써 흐름제어가 수행되는데, 수신 확인응답 방식은 2가지가 있다.
  1. 정지-대기(Stop and wait): 패킷에 대한 응답을 받은 후에 다음 패킷을 보내는 방식으로, 가장 단순한 형태의 자동 재전송 요구(ARQ)로서, 송신 측이 1개의 블록을 전송하면, 수신 측에서 오류의 발생을 점검하여 전송 중 오류가 발생하지 않았을 경우 긍정 응답(ACK)을, 오류가 발생하였을 경우 부정 응답(NAK)을 보낼 때까지 기다리는 방식이다. 이에 따라 송신 측은 다음의 데이터 블록을 전송하거나, 오류가 발생한 데이터 블록을 재전송한다. <br>즉, 송신장치에서 한 번에 하나의 프레임을 전송하고, 송신측에서 프레임을 전송한 후 확인 받을 때까지 다음 프레임을 보낼 수 없도록 <br>대기하는 방식이다.
  2. 슬라이딩 윈도우(sliding window): 가용 데이터 분량의 패킷을 한꺼번에 보낸 후 응답 패킷을 받으면 다시 그만큼의 데이터를 한꺼번에 보내는 방식이다. 송신측이 수신측의 확인 응답을 받기 전에 상대방의 윈도우 사이즈 범위 내 즉, 수신측의 수신 가능한 범위인 <br>수신 버퍼의 여유 공간 크기 내에서 데이터에 해당하는 여러 프레임을 연속해서 전송하는 방식이다. 세그먼트를 전송할 때마다 수신확인응답을 수신한 후 전송하게 되면, 왕복 시간인 RTT(Round Trup Rime)가 길 경우, 단위 시간당 데이터 전송량(Throughput)이 매우<br> 떨어지므로, 효율적으로 전송하기 위해 상대방이 받을 수 있는 범위 내에서 연속적으로 전송한다. 이 방식에서는 송수신 흐름을 위해서 각 프레임에 순서 번호를 부여한다. 순서번호를 부여하여 수신측에서 기대하는 다음 프레임의 순서번호를 포함하는 확인응답 번호를 <br>송신측에 보내줌으로써 계속 받을 수 있는 프레임들의 번호를 알려준다
- `혼잡 제어(Congestion Control)` 네트워크의 혼잡 정도에 따라서 송신자가 데이터의 전송량을 제어하는 것을 말한다. 혼잡 정도에 대한 판단기준은 <br>데이터의 손실 발생 유무로 판단한다. 전송한 데이터에 누락이 발생하면 네트워크가 혼잡한 상태로 판단하여 전송량을 조절하는 것인데, <br>손실, 폐기, 지연 등이 누락에 해당한다. 물리적인 네트워크 장애나, TTL(Time To Live) 초과 등은 손실에, 데이터 오류 등으로 인한 폐기는 <br>폐기에, 네트워크 혼잡 등에 의한 지연은 지연에 해당한다.
- `연결 제어(Connection Control)` 연결제어는 연결 지향형 데이터 전송(Connection oriented data transfer)과 비연결 지향형 데이터 <br>전송(Connectionless data transfer) 두 가지 방식이 있다. 연결 지향형 데이터 전송은 두 시스템이 서로 데이터를 교환할 때 연결을 설정하는 경우로, 연결 설정, 데이터 전송, 연결 해제 3단계로 구성된다. 대표적인 예로 전송 제어 프로토콜(Transmission Control Protocol, TCP)가 있고, 이러한 연결 제어 패킷을 이용하면 네트워크 연결을 끊을 수도, 해당 세션을 빼앗을 수도 있다. <br>비연결 지향형 데이터 전송은 사용자 데이터그램 프로토콜(User Datagram Protocol, UDP)와 같이 연결을 설정하지 않은 경우다. <br>이렇게 전송되는 데이터들은 데이터그램(Datagram) 이라고 한다.
- `오류 제어(Error Control)` 프로토콜 데이터 단위로 데이터를 교환할 때 서비스 데이터 단위나 PCI가 잘못되었는지 발견하는 기법을 의미한다. <br>데이터의 오류나 누락 없이 안전한 전송을 보장해주어야 하는데, 오류나 누락이 발생할 경우 재전송을 수행하여 이를 보장한다. <br>데이터의 오류는 송신측에서 계산한 체크섬(checksum)을 수신측에서 검증하여 오류 여부를 판단한다. 오류의 발생 여부는 패리티 비트(parity bit)나 잉여도 검사(Cyclic Redundancy Check)를 통해 발견할 수 있다. <br>오류 제어는 순서 검사나 특정 시간 안에 데이터를 받지 못하면 재전송을 요구하는 방식으로 이루어진다.
- - > `패리티 비트, 잉여도 검사, 체크섬 추후 기술`
- `동기화(Synchronization)` 송·수신측 간의 데이터를 주고받는 시점을 정확하게 일치시키기 위한 기법이다.
- `다중화(Multiplexing)` 하나의 통신 선로에서 시스템이 동시에 통신할 수 있는 기법을 다중화라고 한다. 조금 더 쉽게 말하자면 하나의 기능 <br>혹은 매체를 여러 영역에서 동시에 사용하는 기법을 말한다. <br>역다중화는 공유하는 기능이나 매체로부터 개별 영역으로 분할하는 기법을 말한다.
- ` 전송 서비스` 우선순위를 결정하고, 서비스 등급과 보안 요구 등을 제어하는 서비스이다

#### Protocal Data Unit(PDU)
- 세션, 표현, 어플리케이션 계층: Message(Data)
- 전송 계층: Segment
- 네트워크 계층: Packets(Datagram 이라고도 함)
- 데이터링크 계층: Frame
- 물리 계층 : Bit
---
### 데이터 캡슐화

#### Protocal Data Unit 구성
- SDU(Service Data Unit) : 전송하려는 데이터
- PCI(Protocal Control Information) : 제어 정보(송신자와 수신자 주소, 오류코드 프로토콜 제어 정보등이 있음)

## OSI 7 계층을 알아야 하는 이유
- 컴퓨터 네트워크를 구성하는 네트워킹 장치들이 데이터를 어떻게 주고받는지에 대한 이해가 컴퓨터 정보통신 분야의 <br>기본이라 할 수 있다.
- OSI 참조 모델은 이러한 컴퓨터 네트워크를 이해하는 데 있어 가장 먼저 숙지해야 할 사항이며 컴퓨터 네트워크를 <br> 설계하거나 네트워크 프로토콜을 설계하기 위한 지침으로 이용하기도 한다.

## OSI 7계층이란?
- Open Systems Interconnection(개방형 시스템 상호연결)의 약자로, 네트워크에서 통신이 일어나는 과정을 7계층으로 나눈 모델.
- 1계층인 물리계층(Physical Layer), 2계층인 데이터링크 계층(DataLink Layer), 3계층인 네트워크 계층(Network Layer), <br>4계층인 전송 계층(Transport Layer), 5계층인 세션 계층(Session Layer), 6계층인 표현 계층(Presentation Layer), <br>7계층인 응용 계층(Application Layer)으로 구성되어 있다.

![image](https://user-images.githubusercontent.com/98382954/180646798-7d1f4146-8055-4b85-97f6-84f49640c2a7.png)
#### OSI 7계층을 나눈 의의?
- ISO(국제표준화기구)가 1984년에 발표했다. 통신이 일어나는 과정을 7단계로 크게 구분하여 한 눈에 들어올 수 있도록 정의했기 때문에 <br>단계별로 파악할 수 있다는 장점이 있다.
- 컴퓨터 통신 구조의 모델과 앞으로 개발될 프로토콜의 표준적인 뼈대를 제공하기 위해 개발된 참조 모델이어서 OSI 7 계층 모델을 알면 <br>네트워크 구성을 예측하고 이해할 수 있다
- 네트워크에서 트래픽의 흐름을 꿰뚫어 볼 수 있으며, 각 계층은 독립되어 있다.
- 7단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건드리지 않고도 이상이 생긴 단계만 고칠 수 있다.
- 분산된 이기종 시스템간의 네트워크 상호호환을 위한 표준 아키텍처를 정의할수 있다.

#### OSI 7계층의 특징?
![image](https://user-images.githubusercontent.com/98382954/180658609-9909e862-b7d3-45b8-a403-7f8f3a6064a5.png)
- OSI 7계층에서는 데이터를 보낼 때(송신) 상위 계층(7계층) -> 하위 (1계층)순으로 데이터를 전달한다. 데이터를 받을 때(수신) 반대로 <br>하위 계층(1계층) -> (7계층) 순으로 전달된 데이터를 받게 된다.
- OSI 7계층에서 데이터를 송신하는 과정 중 사용자 데이터가 각 계층을 지나면서 하위 계층은 상위 계층으로부터 온 정보를 데이터로 <br>취급하며 자신의 계층 특성을 담은 제어정보(주소, 에러 제어 등)를 헤더화 시켜 붙이는 과정을 **데이터 캡슐화**라고 부른다.
- >**캡슐화**의 장점은 동일 계층 간의 호환성을 유지할 수 있고 오류의 영향을 최소화할 수 있다는 것이다.
- OSI 7계층에서 데이터를 수신하는 과정 중 사용자 데이터가 각 계층을 지나며 상위 계층은 하위 계층으로부터 온 정보를 데이터로 <br> 취급하고 상위 계층으로 데이터를 넘겨줄 때는 송신 측 각 계층에서 추가된 헤더를 제거 후 데이터를 넘겨주는 과정을 <br> **데이터 역캡슐화**라고 부른다.

---
### OSI 7계층을 기능별로 나눈다면
- OSI 7 계층은 
- 

