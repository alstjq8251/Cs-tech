## 접근제어

### 리소스와 소유권
- 리눅스는 다중 사용자 운영체제로 유닉스로부터 사용자 개념을 물려받았다.
- 각 사용자 계정은 실행 파일, 파일 장치, 기타 리눅스 자산에 접근할 수 있는 사용자 ID와 연결된다.
- 인간과 프로세스 모두 사용자 계정으로 실행할 수 있고 사용자가 이용 가능한 하드웨어, 소프트웨어 구송요소인 리소스(간단히 `파일`)dl dlTek.
  - 시스템 콜과 같이 다른 종류의 리소에 대한 접근을 명시적으로 언급하지 않으면 리소스는 **파일**로 지칭

`사용자`
- 프로세스를 실행하고 파일을 소유, **프로세스**는 커널이 메인 메모리에 로드해 실행하는 일종의 프로그램(실행 파일)이다.

`파일`
- 소유자가 존재하며 기본적으론 파일을 만든 사용자가 파일을 소유

`프로세스`
- 의사소통과 지속성을 위해 파일을 사용, 사용자도 파일을 간접적으로 사용하긴 하지만 그러려면 프로세스를 통해야 한다.

### 샌드박스
- **샌드박스**의 정의는 다소 모호해 제일(jail)에서 컨테이너, 가상 머신에 이르기까지 커널이나 사용자 영역에서 관리할 수 잇는 다양한 방법을 가리킬 수 있다.
- 일반적으로 샌드박스(대부분 어떤 애플리케이션)에서 실행되는 항목이 있다면 감시 매커니즘은 샌드박스 프로세스와 호스팅 환경 간 어느 정도 격리를 시행한다.

### 접근 제어 유형
- 접근 제어의 한 측면은 접근 자체의 특성이다.
- 개념적으론 다양한 접근 제어 유형이 있으나 리눅스 관점에서 중요한 두가지는 `임의 접근 제어`와 `강제 접근 제어`다.

`임의 접근 제어(discretionary access control)`
- 임의 접근 제어(DAC)를 사용하면 사용자 신분을 기반으로 리소스에 대한 접근을 제한할 수 있다.
  - 여기서 임의란 특정 권한을 가진 사용자가 이를 다른 사용자에게 전달할 수 있음을 의미한다.

`강제 접근 제어(mandatory access control)`
- 강제 접근 제어(MAC)는 보안 수준을 나타내는 계층 모델을 기반으로 한다.
- 사용자에겐 허용 등급이 할당되고 리소스엔 보안 레이블이 할당된다.
- 강제 접근 제어 모델에선 관리자가 모든 권한을 설정하여 엄격하고 배타적으로 접근을 제어한다.
  - 사용자는 리소스를 소유해도 권한을 스스로 설정하지 못한다.

> 리눅스는 `전부 아니면 전무(all of nothing)`라는 태도를 견지한다.
>
> 사용자는 모든 것을 변경할 수 있는 슈퍼 유저이거나 접근이 제한된 일반 사용자 중 하나라는 뜻이다.

<details>
<summary><strong>강제 접근 제어 모델</strong></summary>
<div>

**SE리눅스**(https://oreil.ly/HAOBS)는 가장 잘 알려진 리눅스용 강제 접근 제어 구현 모듈이다.
- 정부 기관의 높은 보안 요구사항을 충족하도록 개발됐으며 엄격한 규칙으로 사용이 어려워 제한적으로 사용된다.

버전 2.6.36부터 리눅스 커널에 포함되어 리눅스 배포판의 우분투 제품군에서 널리 사용되는 **앱 아머**도 있다.

</div>
</details>

### 사용자
- 리눅스에선 목적 또는 의도적 사용 관점에서 사용자 계정을 두 가지 유형으로 구별한다.

1. 시스템 사용자 또는 시스템 계정
   - 프로그램(daemon이라고도 함)은 이런 유형의 계정을 사용해 백그라운드 프로세스를 사용한다.
2. 일반 사용자

이 구분은 조직적인 구성에 가까우며 리눅스는 32비트 숫잣값인 사용자 ID(UID)를 사용해 사용자를 식별하며, 사용자는 그룹 ID(GID)를 통해 식별되는 하나 이상의 그룹에 속한다.

<details>
<summary><strong>systemd 기반 배포판의 UID 범위를 결정하는 규칙</strong></summary>
<div>

- UID 0
  - root 사용자
- UID 1~999
  - 시스템 사용자에게 지정
- UID 65534
  - nobody 사용자. NFS와 같이 원격 사용자를 잘 알려진 ID에 매핑하는데 사용
- UID 1000~65533, 65536~4294967294
  - 일반 사용자

```shell
id -u # 자신의 UID를 알아내는 방법
```

</div>
</details>

#### 로컬에서 사용자 관리
- 첫번째 옵션은 사용자를 로컬에서 관리하는 것인데 로컬에 저장된 정보만 사용하며 이를 위해 리눅스는 간단한 파일 기반 인터페이스를 사용한다.

|    목적    |     파일      |
|:--------:|:-----------:|
| 사용자 데이터베이스 | /etc/passwd | 
| 그룹 데이터베이스 | /etc/group |
| 사용자 비밀번호 | /etc/shadow |
| 그룹 비밀번호 | /etc/gshadow |

<details>
<summary><strong>로컬 사용자 관리에 대한 구체적인 예</strong></summary>
<div>

```shell
cat /etc/passwd
```

</div>
</details>